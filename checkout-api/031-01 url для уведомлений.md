[![яндекс касса](/i/yakassalogo.png "Яндекс Касса")](https://kassa.yandex.ru) / [помощь](https://yandex.ru/support/checkout/) / [api-докуметация](https://kassa.yandex.ru/docs/checkout-api/#api-yandex-kassy), [api-гайды](https://kassa.yandex.ru/docs/guides/#bystryj-start), [YandexCheckout.js](https://kassa.yandex.ru/docs/checkout-js/#yandexcheckout-js)

URL для уведомлений. Решение вопросов
=====================================

### Платеж прошел, колбека нет

**q**: Мы сформировали платеж, получили `confirmation_url`, перешли к оплате и провели её, оплата успешная, но колбека на url для уведомлений нет.

**a**: Проверьте следующие моменты:
1. Урл для уведомлений действительно доступен?
2. В запросе на [создание платежа](https://kassa.yandex.ru/docs/checkout-api/#sozdanie-platezha) было передано `"capture": "true"`? Если да, то в этом случае уведомлений не предусмотрено.

> Уведомление на ваш URL для уведомлений доставляется только при переходе платежа в статус `"waiting_for_capture"`.

#### Статус "waiting_for_capture"

Статус `"waiting_for_capture"` значит, что плательщик выполнил успешную оплату и теперь платеж ожидает вашего capture ([подтверждения платежа](https://kassa.yandex.ru/docs/checkout-api/#podtwerzhdenie-platezha)) (в том числе частичного) или cancel ([отмены](https://kassa.yandex.ru/docs/checkout-api/#otmena-platezha)).

Внимание! В статусе `"waiting_for_capture"`, если это оплата банковской картой, платеж будет находится 7 дней, а для остальных методов платежа 2 часа. В этом интервале вам нужно выполнить capture или cancel. Если вы не выполните capture, то заказ будет отменен (cancel) автоматически и деньги вернутся плательщику.

### Пример уведомления

**q**: Покажите пример уведомления `"waiting_for_capture"`. В каком виде оно приходит?

**a**: Пример уведомления:
```
{"type":"notification","event":"payment.waiting_for_capture","object":{"id":"2185355e-000f-5081-a000-0000000",
"status":"waiting_for_capture","paid":true,"amount":{"value":"10.00","currency":"RUB"},"created_at":"2017-09-27T12:07:58.702Z",
"expires_at":"2017-11-03T12:08:23.080Z","metadata":{},"payment_method":{"type":"bank_card","id":"2185355e-000f-5081-a000-0000000",
"saved":false,"card":{"last4":"1026","expiry_month":"12","expiry_year":"2025","card_type":"Unknown"},"title":"Bank card *1026"},
"recipient":{"account_id":"000005","gateway_id":"0000015"}}}
```

### PHP

**q**: Мы сделали все так, как написано выше, но наш PHP-скрипт не получает никаких данных.

**a**: Скорее всего вы выполняете перехват методом `$_POST`. Попробуйте через `file_put_contents ("путь_до_лога", print_r(json_decode(file_get_contents("php://input")), true));`.
