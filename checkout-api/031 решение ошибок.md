[![яндекс касса](/i/yakassalogo.png "Яндекс Касса")](https://kassa.yandex.ru) / документация / api

:mag: Решение ошибок при платежах
=================================

### Платеж прошел, колбека нет

**q**: Я сформировал платеж, получил `confirmation_url`, перешел по нему, провел оплату, оплата успешная, но колбека на мой url для уведомлений нет.

**a**: Проверьте следующие моменты:
1. Урл для уведомлений действительно доступен?
2. В запросе на [создание платежа](https://kassa.yandex.ru/docs/checkout-api/#sozdanie-platezha) было передано `"capture": "true"`. В этом случае уведомлений не предусмотрено.

> Уведомление на ваш URL для уведомлений доставляется только в одном случае: когда [создание платежа](https://kassa.yandex.ru/docs/checkout-api/#sozdanie-platezha) было выполнено без `"capture": "true"`. В этом случае, после оплаты, заказ переходит в состояние `"status": "waiting_for_capture"` и только в этом случае будет уведомление на ваш URL.

#### Пример уведомления на ваш URL для уведомлений

```
{
  "id": "215d8da0-000f-50be-b000-0003308c89be",
  "status": "waiting_for_capture",
  "paid": true,
  "amount": {
    "value": "4.00",
    "currency": "RUB"
  },
  "charge": {
    "value": "4.00",
    "currency": "RUB"
  },
  "created_at": "2017-09-27T10:13:52.588Z",
  "metadata": {},
  "payment_method": {
    "type": "bank_card",
    "id": "012b57fe-1904-493a-a2de-48cd42c4f356",
    "saved": false,
    "card": {
      "last4": "4448",
      "expiry_month": "04",
      "expiry_year": "2020",
      "card_type": "MasterCard"
    },
    "title": "Bank card *4448"
  }
}
```

N.B.: После этого, чтобы заказ перешел в `"status": "succeeded"` вы должны выполнить capture ([подтверждение платежа](https://kassa.yandex.ru/docs/checkout-api/#podtwerzhdenie-platezha))
